\documentclass[a4paper,12pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{longtable}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{datetime}
\usepackage{indentfirst}
\usepackage{subfigure}
\usepackage[section]{placeins}
\usepackage{afterpage}
\usepackage{url}
\usepackage[unicode]{hyperref}
\usepackage{ucs}
\usepackage{listings}
\usepackage{microtype}
\usepackage{paralist}
\usepackage{multirow}
\usepackage{color}
\usepackage{xcolor}
\usepackage{float}
\usepackage{graphicx}
\usepackage{sectsty}
\usepackage{fancyhdr}
\usepackage{longtable}
\usepackage{appendix}
\usepackage{enumerate}
\usepackage{totcount}
\usepackage{verbments}
\usepackage{perpage}
\usepackage{caption}
\usepackage{varwidth}

\newfloat{floatquote}{tbp}{loq}
\floatname{floatquote}{Цитата}
%\captionsetup{font =small, format = hang}
\usepackage{cleveref}
\crefname{floatquote}{quote}{quotes}
\Crefname{floatquote}{Quote}{Quotes}
\DeclareFontShape{OT1}{cmtt}{bx}{n}{<5><6><7><8><9><10><10.95><12><14.4><17.28><20.74><24.88>cmttb10}{}

\makeatletter
\renewcommand{\@biblabel}[1]{#1.}
\makeatother

\usepackage{geometry}
\geometry{left=2cm}
\geometry{right=2cm}
\geometry{top=2cm}
\geometry{bottom=2cm}

%% from bachelor-paper begin 
\fancyhf{}
\fancyfoot[C]{\normalsize \thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

%%Modifying captions for figures and tables:
%\makeatletter
%\long\def\@makecaption#1#2{%
%\vspace{\abovecaptionskip}%
%\sbox{\@tempboxa}{\large #1.~#2}
%\ifdim \wd\@tempboxa >\hsize
%% {\normalsize #1 --- #2}\par
%\global\@minipagefalse
%\hbox to \hsize {\hfill {\normalsize #1 --- #2}\hfill}%
%\else
%% {\normalsize #1 --- #2}\par
%\global\@minipagefalse
%\hbox to \hsize {\hfill {\normalsize #1 --- #2}\hfill}%
%\fi
%\vspace{\belowcaptionskip}}

\DeclareCaptionFormat{myformat}{%
    % #1: label (e.g. "Table 1")
    % #2: separator (e.g. ": ")
    % #3: caption text
    \begin{varwidth}{\linewidth}%
        \centering
        #1 --- #3%
    \end{varwidth}%
}
\captionsetup{format=myformat}% global activation

%% replaced with linespread? \renewcommand{\baselinestretch}{1.2}
\sectionfont{\Large}
\subsectionfont{\Large}
\subsubsectionfont{\Large}
\setlength{\belowcaptionskip}{6pt}
%% \makeatletter \renewcommand{\@biblabel}[1]{#1.\hfill}

\makeatletter 
\def\redeflsection{\def\l@section{\@dottedtocline{1}{1.5em}{7.8em}}} 
\renewcommand\appendix{\par 
\setcounter{section}{0}% 
\setcounter{subsection}{0}% 
\def\@chapapp{\appendixname}% 
\addtocontents{toc}{\protect\redeflsection} 
\def\thesection{\appendixname\hspace{0.2cm}\@Asbuk\c@section}} 
\makeatother 

\textwidth = 17cm
\oddsidemargin= 0 pt
\topmargin = -1cm
\headheight = 0cm
\headsep = 0cm
\textheight = 26.5cm

\newtotcounter[auxfile=totals.aux]{figurecnt}
\def\oldfigure{} \let\oldfigure=\figure
\def\figure{\stepcounter{figurecnt}\oldfigure}
\newtotcounter[auxfile=totals.aux]{bibcnt}
\def\oldbibitem{} \let\oldbibitem=\bibitem
\def\bibitem{\stepcounter{bibcnt}\oldbibitem}
\regtotcounter[auxfile=totals.aux]{page}

\linespread{1.3}

\newcommand{\td}{ (\#TODO) }
\newcommand{\todo}[1]{(\#TODO: #1)}
\newcommand{\doubletext}[2]{
	\noindent\begin{minipage}[b]{0.5\linewidth}
        #1
	\end{minipage}
	\noindent\begin{minipage}[b]{0.45\linewidth}
        \begin{flushright}
            #2
        \end{flushright}
    \end{minipage}
}

%\renewcommand{\theenumi}{\arabic{enumi}}
%\renewcommand{\labelenumi}{\arabic{enumi}}
%\renewcommand{\theenumii}{.\arabic{enumii}}
%\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}
%\renewcommand{\theenumiii}{.\arabic{enumiii}}
%\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.}

\floatstyle{plain} % optionally change the style of the new float
\newfloat{code}{H}{myc}

\newcommand{\fu}[1]{\footnote{\url{#1}}}

%\definecolor{javapurple}{rgb}{0.25,0.35,0.9} % keywords
%% \definecolor{javapurple}{rgb}{0.1,0.1,0.1}


%\lstset{
%captionpos=b,
%breaklines=true,
%% basicstyle=\ttfamily,
%keywordstyle=\bfseries,
%% keywordstyle=\color{javapurple}\bfseries,
%% basicstyle=\ttfamily\color{black},
%% keywordstyle=\bfseries\color{keyword},
%showstringspaces=false,
%morekeywords={fun, val, var, import, object, uses, classpath, let, for, do, select, in, return, new, null, class}
%}

\MakePerPage{footnote}

\begin{document}
\def\figurename{Рисунок}

\input{title}

\addcontentsline{toc}{section}{Содержание}
\tableofcontents

\input{intro}
\input{survey}
\input{compilers_survey}
\input{benchmarks}

\newpage
\nocite{*}
\bibliographystyle{bplain}
\bibliography{biblio}

\end{document}

